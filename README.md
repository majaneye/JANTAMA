# JantamaViewerについて

このツールはじゃんたまの牌譜を解析して、４人麻雀の半荘（東風）のまとめを作成します。

現在、実装されているのは以下の機能です。
- 各局の結果表示（上がりまたは流局、点棒移動、立直、和了役）
- 点棒状況のグラフ表示
- 局毎の天鳳の牌譜エディタ用テキストへの変換
- 牌譜の再生（牌譜ビューワー）
- 放銃リスト
- スタッツの表示
- リーグ戦（チーム戦）機能

## 使い方

自身の環境に合わせて、Win または Macのzipファイルをダウンロードしてください。
解凍した先のPaifuフォルダにじゃんたまの牌譜（**牌譜の入手については後述**）を入れてください。牌譜はJantamaViewerを起動後に追加しても構いません。
牌譜追加後に解析ボタンを押すと、牌譜を解析して半荘（東風）のまとめを作成します。
各局のまとめをクリックすると、天鳳の牌譜エディタ用テキストをクリップボードにコピーします。

#### まとめに大会戦の名前を表示する
Settings/contest_id.txtにIDと名前を追加することで大会戦の名前を表示します。

#### ドロップダウンリストにプレイヤー名を登録する
Settings/player_id.txtにIDと名前を追加することで検索用プレイヤー名を登録します。

#### フォルダでフィルタリングを行う
Paifuフォルダ以下にフォルダを作成します。例えば、次のようなフォルダを作ります。
ドロップダウンリストで”/Paifu/自分"を選択すると、"自分"フォルダ以下の牌譜がフィルタリングされます。

Paifu/自分

Paifu/自分/8月

Paifu/自分/9月

## リーグ戦、チーム戦のランキング表示

上部の【リーグ戦】タブを選択すると、指定フォルダ以下にある牌譜で、絞り込み条件に一致する牌譜の順位、持ち点からポイントを算出してランキングを表示します。
ランキング表示は順位、プレイヤー名（チーム名）、ポイント、対局数を見ることができます。
【pt集形式】のドロップダウンリストは順位と持ち点からのポイントの算出方法を指定します。
↓のファイルに追加することが可能です。デフォルトは１番上の行です。
Settings/Leagues/calc_base.txt

【集計対象】のドロップダウンリストは個人成績またはチーム成績としてまとめたものを表示するか切り替えます。
個人成績の場合は、絞り込まれた牌譜に登場するプレイヤーが全てランキングに表示されます。
チーム成績の場合は、 Settings/Leagues/team フォルダ以下にある「リーグ戦名」.txtに記述されたチームのメンバーの成績をまとめたものが表示されます。
※チームとして記載してあると、対局数が0でもランキングに表示されます。

「リーグ戦名1」.txt,「リーグ戦名2」.txtを作成すると、
ドロップダウンリストには[個人成績］,[リーグ戦名1］,[リーグ戦名2]が表示されます。

「リーグ戦名」.txtの記述例
　じゃんたま愛好会.txt
#チーム名,メンバー１のアカウントID,メンバー２のアカウントID,...
チーム一姫推し,000000,0000001
チーム二階堂推し,000002,0000003
チームXXX,9999,3333,333333

チーム数は何個でも大丈夫です。
メンバー数は同じでなくても構いません。
０人のチームやチームが一つも登録されていない場合については保証してないのでご注意ください。


## 牌譜について

牌譜のダウンロードはこちらのWikiをご覧ください。（作成者様に感謝します。ファイルの解析でもとても参考になりました）
雀魂 API 解析にゃ！ Wiki*

牌譜をファイルに保存するにゃ
https://wikiwiki.jp/majsoul-api/%E7%89%8C%E8%AD%9C%E3%82%92%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%AB%E4%BF%9D%E5%AD%98%E3%81%99%E3%82%8B%E3%81%AB%E3%82%83

paifu()と入力してウィンドウを表示するより、paifu("雀魂牌譜: https://game.mahjongsoul.com/?paipu=UUID")とする方がちょっと楽でした。

## プレビュー

画像は神域リーグ様の牌譜をお借りして作成しました。

![スクリーンショット 2022-07-18 2 00 33](https://user-images.githubusercontent.com/108359839/179417467-12d4b5ec-e0e4-43a6-9c48-07dc46d21e80.png)

<img width="1076" alt="スクリーンショット 2022-07-18 2 45 18" src="https://user-images.githubusercontent.com/108359839/179418192-e2559c0c-26e0-492e-9fc0-bbd8b0f03131.png">

